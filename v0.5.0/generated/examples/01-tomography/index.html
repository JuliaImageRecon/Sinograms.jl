<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tomography overview · Sinograms.jl</title><meta name="title" content="Tomography overview · Sinograms.jl"/><meta property="og:title" content="Tomography overview · Sinograms.jl"/><meta property="twitter:title" content="Tomography overview · Sinograms.jl"/><meta name="description" content="Documentation for Sinograms.jl."/><meta property="og:description" content="Documentation for Sinograms.jl."/><meta property="twitter:description" content="Documentation for Sinograms.jl."/><meta property="og:url" content="https://JuliaImageRecon.github.io/Sinograms.jl/stable/generated/examples/01-tomography/"/><meta property="twitter:url" content="https://JuliaImageRecon.github.io/Sinograms.jl/stable/generated/examples/01-tomography/"/><link rel="canonical" href="https://JuliaImageRecon.github.io/Sinograms.jl/stable/generated/examples/01-tomography/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Sinograms.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Sinograms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../methods/">Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Tomography overview</a><ul class="internal"><li><a class="tocitem" href="#Tomography"><span>Tomography</span></a></li><li><a class="tocitem" href="#Radon-transform"><span>Radon transform</span></a></li><li><a class="tocitem" href="#Sinogram-example"><span>Sinogram example</span></a></li><li><a class="tocitem" href="#Image-reconstruction"><span>Image reconstruction</span></a></li><li><a class="tocitem" href="#FBP"><span>FBP</span></a></li><li><a class="tocitem" href="#Noise-effects-on-FBP"><span>Noise effects on FBP</span></a></li></ul></li><li><a class="tocitem" href="../02-sino-geom/">2D sinogram geometry</a></li><li><a class="tocitem" href="../03-parallel-beam/">Parallel-beam tomography</a></li><li><a class="tocitem" href="../04-fan-arc/">Fan-beam tomography: arc detector</a></li><li><a class="tocitem" href="../05-fan-flat/">Fan-beam tomography: flat detector</a></li><li><a class="tocitem" href="../06-fan-short/">Fan-beam tomography: short scan</a></li><li><a class="tocitem" href="../07-fdk/">CBCT FDK</a></li><li><a class="tocitem" href="../08-bdd2d/">2D Branchless Distance-driven Projection and Backprojection</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Tomography overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tomography overview</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/Sinograms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/Sinograms.jl/blob/main/docs/lit/examples/01-tomography.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="01-tomography"><a class="docs-heading-anchor" href="#01-tomography">Tomography overview</a><a id="01-tomography-1"></a><a class="docs-heading-anchor-permalink" href="#01-tomography" title="Permalink"></a></h1><p>This page gives an overview of the Julia package <a href="https://github.com/JuliaImageRecon/Sinograms.jl"><code>Sinograms.jl</code></a>.</p><p>This page comes from a single Julia file: <a href="https://github.com/JuliaImageRecon/Sinograms.jl/blob/main/docs/lit/examples/01-tomography.jl"><code>01-tomography.jl</code></a>.</p><p>You can access the source code for such Julia documentation using the &#39;Edit on GitHub&#39; link in the top right. You can view the corresponding notebook in <a href="https://nbviewer.org/">nbviewer</a> here: <a href="https://nbviewer.org/github/JuliaImageRecon/Sinograms.jl/tree/gh-pages/dev/generated/examples/01-tomography.ipynb"><code>01-tomography.ipynb</code></a>, or open it in <a href="https://mybinder.org/">binder</a> here: <a href="https://mybinder.org/v2/gh/JuliaImageRecon/Sinograms.jl/gh-pages?filepath=dev/generated/examples/01-tomography.ipynb"><code>01-tomography.ipynb</code></a>.</p><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><p>Packages needed here.</p><pre><code class="language-julia hljs">using Sinograms: fbp
using MIRTjim: jim, prompt
using InteractiveUtils: versioninfo</code></pre><p>The following line is helpful when running this file as a script; this way it will prompt user to hit a key after each figure is displayed.</p><pre><code class="language-julia hljs">isinteractive() ? jim(:prompt, true) : prompt(:draw);</code></pre><h2 id="Tomography"><a class="docs-heading-anchor" href="#Tomography">Tomography</a><a id="Tomography-1"></a><a class="docs-heading-anchor-permalink" href="#Tomography" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/Tomography">Tomography</a> is the process of imaging cross sections of an object without actually slicing the object. There are many forms of tomography; the description here focuses on <a href="https://en.wikipedia.org/wiki/CT_scan">X-ray computed tomography (CT scans)</a>. (See <a href="https://github.com/JeffFessler/SPECTrecon.jl">SPECTrecon.jl</a> for a Julia package related to <a href="https://en.wikipedia.org/wiki/Single-photon_emission_computed_tomography">SPECT</a> imaging.)</p><p>In an <a href="https://en.wikipedia.org/wiki/File:Ct-internals.jpg">X-ray CT imaging system</a>, X-rays emitted from an X-ray source are transmitted through an object (e.g., a patient in medical CT) towards a detector array. The source and detector <a href="https://www.youtube.com/watch?v=2CWpZKuy-NE">rotate rapidly</a> around the object. The signal intensities recorded by the detector are related to the sizes and densities of the object materials between the source and each detector element.</p><h2 id="Radon-transform"><a class="docs-heading-anchor" href="#Radon-transform">Radon transform</a><a id="Radon-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Radon-transform" title="Permalink"></a></h2><p>The mathematical foundation for 2D X-ray CT imaging is the <a href="https://en.wikipedia.org/wiki/Radon_transform">Radon transform</a>, an <a href="https://en.wikipedia.org/wiki/Integral_transform">integral transform</a> that maps a 2D function <span>$f(x,y)$</span> into the collection of line integrals through that function. Here we describe each line by its angle <span>$\phi$</span> measured counter-clockwise from the <span>$y$</span> axis, and by the radial distance <span>$r$</span> of the line from the origin. The collection of integrals is called a sinogram.</p><p>Mathematically, the Radon transform <span>$p(r,\phi)$</span> of <span>$f(x,y)$</span> is defined by</p><p class="math-container">\[p(r,\phi) = \int_{-\infty}^{\infty}
f(r \cos \phi - l \sin \phi,
r \sin \phi + l \cos \phi) \, \mathrm{d} l.\]</p><p>The Radon transform of the object that is 1 inside the unit disk and 0 elsewhere is given by</p><p class="math-container">\[p_1(r,\phi) = 2 \sqrt{1 - r^2}, \ \mathrm{ for } \ |r| &lt; 1.\]</p><p>By the Radon transform&#39;s translation and scaling properties, the Radon transform of a disk of radius <span>$r_0$</span> centered at <span>$(x_0,y_0)$</span> is given by</p><p class="math-container">\[p(r,\phi) = r_0 \, p_1
\left( \frac{r - (x_0 \cos \phi + y_0 \sin \phi)}{r_0}, ϕ \right).\]</p><h2 id="Sinogram-example"><a class="docs-heading-anchor" href="#Sinogram-example">Sinogram example</a><a id="Sinogram-example-1"></a><a class="docs-heading-anchor-permalink" href="#Sinogram-example" title="Permalink"></a></h2><p>Here is a display of that Radon transform for a disk of radius <span>$3$</span> centered at coordinate <span>$(5,1)$</span>. Note that maximum value is approximately <span>$6$</span>, the length of the longest chord through a disk of radius <span>$3$</span>.</p><pre><code class="language-julia hljs">nr = 128
dr = 20 / nr
r = ((-(nr-1)/2):((nr-1)/2)) * dr # radial sample locations
na = 130
ϕ = (0:(na-1))/na * π # angular samples
proj1 = r -&gt; abs(r) &lt; 1 ? 2 * sqrt(1 - r^2) : 0.
proj2 = (r, ϕ, x, y, r0) -&gt; r0 * proj1(r/r0 - (x * cos(ϕ) + y * sin(ϕ))/r0)
sino = proj2.(r, ϕ&#39;, 5, 1, 3)
jimsino = (sino, title) -&gt; jim(
    r, ϕ, sino; title, aspect_ratio=:none,
    xlabel = &quot;r&quot;, ylabel = &quot;ϕ&quot;, ylims=(0,π), yticks=([0, π], [&quot;0&quot;, &quot;π&quot;]),
    yflip=false, xticks = [-10, 0, 2, 5, 8, 10],
    clim = (0, 6),
)
jimsino(sino, &quot;Sinogram for one disk&quot;)</code></pre><img src="1e99a76d.svg" alt="Example block output"/><p>As this figure illustrates, the Radon transform of a unit disk has a somewhat sinusoidal shape. Indeed every point in the <span>$(x,y)$</span> plane traces out a distinct sinusoid in the sinogram.</p><p>The mapping from the object <span>$f(x,y)$</span> to data like the sinogram <span>$p(r,\phi)$</span> is called the &quot;forward problem.&quot;</p><h2 id="Image-reconstruction"><a class="docs-heading-anchor" href="#Image-reconstruction">Image reconstruction</a><a id="Image-reconstruction-1"></a><a class="docs-heading-anchor-permalink" href="#Image-reconstruction" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/Image_reconstruction">Image reconstruction</a> is the process of solving the <a href="https://en.wikipedia.org/wiki/Inverse_problem">inverse problem</a> of recovering an estimate <span>$\hat{f}(x,y)$</span> of the object <span>$f(x,y)$</span> from a measured sinogram, i.e., from (usually noisy) samples of <span>$p(r,\phi)$</span>.</p><h2 id="FBP"><a class="docs-heading-anchor" href="#FBP">FBP</a><a id="FBP-1"></a><a class="docs-heading-anchor-permalink" href="#FBP" title="Permalink"></a></h2><p>A simple image reconstruction method is called the &quot;filtered back-projection&quot; (FBP) approach. It works by filtering each row of the sinogram with a filter, called the <a href="https://en.wikipedia.org/wiki/Radon_transform#Radon_inversion_formula">ramp filter</a>, whose frequency response is roughly <span>$|\nu|$</span>, where <span>$\nu$</span> is the spatial frequency variable (units cycles / m), followed by a <a href="https://en.wikipedia.org/wiki/Radon_transform#Dual_transform">back-projection</a> step that is the <a href="https://en.wikipedia.org/wiki/Hermitian_adjoint">adjoint</a> of the Radon transform.</p><h3 id="FBP-example"><a class="docs-heading-anchor" href="#FBP-example">FBP example</a><a id="FBP-example-1"></a><a class="docs-heading-anchor-permalink" href="#FBP-example" title="Permalink"></a></h3><p>Here is an illustration of using the <code>fbp</code> method in this package to perform image reconstruction from the preceding sinogram.</p><pre><code class="language-julia hljs">image = fbp(sino; dr)
(nx,ny) = size(image)
dx = dr # default
x = ((-(nx-1)/2):((nx-1)/2)) * dr
y = x
jim(x, y, image, &quot;FBP image&quot;,
    xtick=[-10, 0, 2, 5, 8, 10],
    ytick=[-10, 0, -2, 1, 4, 10],
)</code></pre><img src="fd0f329f.svg" alt="Example block output"/><p>The FBP reconstructed image looks pretty similar to a disk of radius <span>$3$</span> centered at <span>$(5,1)$</span> as expected. However, there are quite a few ripples; these are <a href="https://en.wikipedia.org/wiki/Aliasing">aliasing</a> artifacts due to the finite sampling in <span>$r$</span> and <span>$\phi$</span>.</p><p>This is example is what is called 2D parallel-beam tomography, because for the angles <span>$\phi$</span> are equally spaced and for each angle the radial samples <span>$r$</span> are also equally spaced. This package includes FBP reconstruction methods for several other sinogram geometries, including the well-known fan beam geometries and the specialized Mojette geometry.</p><h2 id="Noise-effects-on-FBP"><a class="docs-heading-anchor" href="#Noise-effects-on-FBP">Noise effects on FBP</a><a id="Noise-effects-on-FBP-1"></a><a class="docs-heading-anchor-permalink" href="#Noise-effects-on-FBP" title="Permalink"></a></h2><p>Simulating the effects of measurement noise in sinogram leads to even worse FBP results.</p><p>First note that a practical imaging system has a finite field of view (FOV):</p><pre><code class="language-julia hljs">rmax = maximum(r)
fovmask = @. sqrt(abs2(x) + abs2(y)&#39;) ≤ rmax
jim(x, y, fovmask, &quot;FOV mask&quot;)</code></pre><img src="254d5901.svg" alt="Example block output"/><p>Add noise to the original sinogram:</p><pre><code class="language-julia hljs">noisy_sinogram = sino + 0.1 * randn(size(sino))
jimsino(noisy_sinogram, &quot;Noisy sinogram&quot;)</code></pre><img src="5529ad2c.svg" alt="Example block output"/><p>Apply FBP to the noisy sinogram:</p><pre><code class="language-julia hljs">noisy_fbp_image = fbp(noisy_sinogram; dr)
noisy_fbp_image .*= fovmask # apply FOV mask
jim(x, y, noisy_fbp_image, &quot;Noisy FBP image&quot;; clim=(0,1))</code></pre><img src="af980340.svg" alt="Example block output"/><p>The methods in this package (WIP) and related methods in the <a href="https://github.com/JuliaImageRecon">JuliaImageRecon</a> suite are designed to provide better reconstructions than the simple FBP method. In particular, model-based image reconstruction (MBIR) methods and methods that use suitable machine-learning approaches can improve image quality significantly. See this <a href="https://doi.org/10.1109/JPROC.2019.2936204">2020 survey paper</a>.</p><h3 id="Reproducibility"><a class="docs-heading-anchor" href="#Reproducibility">Reproducibility</a><a id="Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Reproducibility" title="Permalink"></a></h3><p>This page was generated with the following version of Julia:</p><pre><code class="language-julia hljs">using InteractiveUtils: versioninfo
io = IOBuffer(); versioninfo(io); split(String(take!(io)), &#39;\n&#39;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">12-element Vector{SubString{String}}:
 &quot;Julia Version 1.10.3&quot;
 &quot;Commit 0b4590a5507 (2024-04-30 10:59 UTC)&quot;
 &quot;Build Info:&quot;
 &quot;  Official https://julialang.org/ release&quot;
 &quot;Platform Info:&quot;
 &quot;  OS: Linux (x86_64-linux-gnu)&quot;
 &quot;  CPU: 4 × AMD EPYC 7763 64-Core Processor&quot;
 &quot;  WORD_SIZE: 64&quot;
 &quot;  LIBM: libopenlibm&quot;
 &quot;  LLVM: libLLVM-15.0.7 (ORCJIT, znver3)&quot;
 &quot;Threads: 1 default, 0 interactive, 1 GC (on 4 virtual cores)&quot;
 &quot;&quot;</code></pre><p>And with the following package versions</p><pre><code class="language-julia hljs">import Pkg; Pkg.status()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Status `~/work/Sinograms.jl/Sinograms.jl/docs/Project.toml`
  [39de3d68] AxisArrays v0.4.7
  [e30172f5] Documenter v1.4.1
  [9ee76f2b] ImageGeoms v0.11.0
  [71a99df6] ImagePhantoms v0.8.0
  [98b081ad] Literate v2.18.0
  [170b2178] MIRTjim v0.24.0
  [6fe1bfb0] OffsetArrays v1.14.0
  [91a5bcdd] Plots v1.40.4
  [02a14def] Sinograms v0.5.0 `~/work/Sinograms.jl/Sinograms.jl`
  [1986cc42] Unitful v1.20.0</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../methods/">« Methods</a><a class="docs-footer-nextpage" href="../02-sino-geom/">2D sinogram geometry »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 17 May 2024 15:57">Friday 17 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
