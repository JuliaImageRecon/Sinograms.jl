<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2D sinogram geometry · Sinograms.jl</title><meta name="title" content="2D sinogram geometry · Sinograms.jl"/><meta property="og:title" content="2D sinogram geometry · Sinograms.jl"/><meta property="twitter:title" content="2D sinogram geometry · Sinograms.jl"/><meta name="description" content="Documentation for Sinograms.jl."/><meta property="og:description" content="Documentation for Sinograms.jl."/><meta property="twitter:description" content="Documentation for Sinograms.jl."/><meta property="og:url" content="https://JuliaImageRecon.github.io/Sinograms.jl/stable/generated/examples/02-sino-geom/"/><meta property="twitter:url" content="https://JuliaImageRecon.github.io/Sinograms.jl/stable/generated/examples/02-sino-geom/"/><link rel="canonical" href="https://JuliaImageRecon.github.io/Sinograms.jl/stable/generated/examples/02-sino-geom/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Sinograms.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Sinograms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../methods/">Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../01-tomography/">Tomography overview</a></li><li class="is-active"><a class="tocitem" href>2D sinogram geometry</a><ul class="internal"><li><a class="tocitem" href="#2D-Sinogram-geometries"><span>2D Sinogram geometries</span></a></li><li><a class="tocitem" href="#Parallel-beam-geometry"><span>Parallel-beam geometry</span></a></li><li><a class="tocitem" href="#Fan-beam-CT-with-an-arc-detector-(3rd-generation-CT)"><span>Fan-beam CT with an arc detector (3rd generation CT)</span></a></li><li><a class="tocitem" href="#Fan-beam-CT-with-a-flat-detector"><span>Fan-beam CT with a flat detector</span></a></li><li><a class="tocitem" href="#Mojette-sampling"><span>Mojette sampling</span></a></li></ul></li><li><a class="tocitem" href="../03-parallel-beam/">Parallel-beam tomography</a></li><li><a class="tocitem" href="../04-fan-arc/">Fan-beam tomography: arc detector</a></li><li><a class="tocitem" href="../05-fan-flat/">Fan-beam tomography: flat detector</a></li><li><a class="tocitem" href="../06-fan-short/">Fan-beam tomography: short scan</a></li><li><a class="tocitem" href="../07-fdk/">CBCT FDK</a></li><li><a class="tocitem" href="../08-bdd2d/">2D Branchless Distance-driven Projection and Backprojection</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>2D sinogram geometry</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2D sinogram geometry</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/Sinograms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaImageRecon/Sinograms.jl/blob/main/docs/lit/examples/02-sino-geom.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="02-sino-geom"><a class="docs-heading-anchor" href="#02-sino-geom">2D sinogram geometry</a><a id="02-sino-geom-1"></a><a class="docs-heading-anchor-permalink" href="#02-sino-geom" title="Permalink"></a></h1><p>This page describes the 2D sinogram geometries available in the Julia package <a href="https://github.com/JuliaImageRecon/Sinograms.jl"><code>Sinograms.jl</code></a>.</p><p>This page comes from a single Julia file: <a href="https://github.com/JuliaImageRecon/Sinograms.jl/blob/main/docs/lit/examples/02-sino-geom.jl"><code>02-sino-geom.jl</code></a>.</p><p>You can access the source code for such Julia documentation using the &#39;Edit on GitHub&#39; link in the top right. You can view the corresponding notebook in <a href="https://nbviewer.org/">nbviewer</a> here: <a href="https://nbviewer.org/github/JuliaImageRecon/Sinograms.jl/tree/gh-pages/dev/generated/examples/02-sino-geom.ipynb"><code>02-sino-geom.ipynb</code></a>, or open it in <a href="https://mybinder.org/">binder</a> here: <a href="https://mybinder.org/v2/gh/JuliaImageRecon/Sinograms.jl/gh-pages?filepath=dev/generated/examples/02-sino-geom.ipynb"><code>02-sino-geom.ipynb</code></a>.</p><h3 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h3><p>Packages needed here.</p><pre><code class="language-julia hljs">using Unitful: mm, °
using Plots # these 2 must precede &#39;using Sinograms&#39; for sino_plot_rays to work
using Sinograms: SinoPar, SinoMoj, SinoFanArc, SinoFanFlat, SinoFan
using Sinograms: sino_plot_rays, rays, angles
using MIRTjim: jim, prompt
using InteractiveUtils: versioninfo</code></pre><p>The following line is helpful when running this file as a script; this way it will prompt user to hit a key after each figure is displayed.</p><pre><code class="language-julia hljs">isinteractive() ? jim(:prompt, true) : prompt(:draw);</code></pre><h2 id="2D-Sinogram-geometries"><a class="docs-heading-anchor" href="#2D-Sinogram-geometries">2D Sinogram geometries</a><a id="2D-Sinogram-geometries-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Sinogram-geometries" title="Permalink"></a></h2><p>To perform 2D image reconstruction from a 2D sinogram, one must first describe how the rays in the sinogram are sampled.</p><p>Mathematically, the Radon transform <span>$p(r,\phi)$</span> of <span>$f(x,y)$</span> is defined for all <span>$r$</span> and <span>$ϕ$</span> but practical systems record <span>$p(r,ϕ)$</span> only for certain finite sets of samples of those values.</p><h2 id="Parallel-beam-geometry"><a class="docs-heading-anchor" href="#Parallel-beam-geometry">Parallel-beam geometry</a><a id="Parallel-beam-geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-beam-geometry" title="Permalink"></a></h2><p>The simplest form of sinogram sampling is equally spaced samples in both <span>$r$</span> and <span>$ϕ$</span>. This sampling is called a parallel-beam geometry. (Very few practical systems have this sampling pattern, but it is an easy place to start.) Both FBP and iterative reconstruction methods need to know which values of <span>$r$</span> and <span>$ϕ$</span> are sampled.</p><p>In this package, <code>SinoPar</code> is the type that describes a parallel-beam sinogram geometry.</p><p>The built-in defaults provide helpful reminders about the usage.</p><pre><code class="language-julia hljs">SinoPar()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SinoPar{Float32, Float32} :
 nb::Int64 128
 d::Float32 1.0
 offset::Float32 0.0
 na::Int64 200
 orbit::Float32 180.0
 orbit_start::Float32 0.0
</code></pre><p>This package supports units via the <a href="https://github.com/PainterQubits/Unitful.jl">Unitful.jl</a> and using units is recommended (but not required).</p><p>Here is an example of how to specify a parallel-beam geometry. Everything is a named keyword argument with sensible default values.</p><ul><li><code>orbit</code> and <code>orbit_start</code> must both be unitless (degrees) or have the same units (e.g., degrees or radians).</li><li>detector spacing <code>d</code> (can be unitless or have units e.g., mm).</li><li>The projection angles <span>$ϕ$</span> are equally space and given by <code>orbit_start + (0:(nb-1))/nb * orbit</code>.</li></ul><pre><code class="language-julia hljs">rg = SinoPar( ;
    nb = 64, # number of radial samples (&quot;bins&quot;)
    na = 30, # number of angular samples
    d = 2mm, # detector spacing
    offset = 0.25, # quarter detector offset (unitless)
    orbit = 180, # angular range (in degrees)
    orbit_start = 0, # starting angle (in degrees)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SinoPar{Unitful.Quantity{Int64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}, Float32} :
 nb::Int64 64
 d::Unit{Int64} 2 mm
 offset::Float32 0.25
 na::Int64 30
 orbit::Float32 180.0
 orbit_start::Float32 0.0
</code></pre><p>The struct <code>rg</code> has numerous useful properties; type <code>?SinoGeom</code> to see the full list.</p><p>For example, to access the angular samples in degrees type <code>angles(rg)</code></p><pre><code class="language-julia hljs">angles(rg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0f0:6.0f0:174.0f0</code></pre><p>The following function visualizes the sampling pattern.</p><pre><code class="language-julia hljs">sino_plot_rays(rg; ylims=(0,180), yticks=(0:90:180), widen=true, title=&quot;Parallel&quot;)</code></pre><img src="f5729290.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()</code></pre><h2 id="Fan-beam-CT-with-an-arc-detector-(3rd-generation-CT)"><a class="docs-heading-anchor" href="#Fan-beam-CT-with-an-arc-detector-(3rd-generation-CT)">Fan-beam CT with an arc detector (3rd generation CT)</a><a id="Fan-beam-CT-with-an-arc-detector-(3rd-generation-CT)-1"></a><a class="docs-heading-anchor-permalink" href="#Fan-beam-CT-with-an-arc-detector-(3rd-generation-CT)" title="Permalink"></a></h2><p>For a fan-beam geometry, the arguments are the same as for <code>SinoPar</code> with the addition of specifying:</p><ul><li><code>dsd</code> distance from source to detector</li><li><code>dod</code> distance from origin (isocenter) to detector</li><li><code>dfs</code> distance from focal point of detector to source (0 for a 3rd gen arc detector, and <code>Inf</code> for a flat detector)</li><li><code>source_offset</code> for misaligned systems  where the ray from the source to the detector center  does not intersect the isocenter.  Not fully supported; submit an issue if you need this feature.</li></ul><p>Here is an example that corresponds to a GE Lightspeed CT system. These numbers are published in <a href="https://doi.org/10.1109/TMI.2006.882141">IEEE T-MI Oct. 2006, p.1272-1283</a>.</p><pre><code class="language-julia hljs">rg = SinoFanArc( ; nb=888, na=984,
    d=1.0239mm, offset=1.25, dsd=949.075mm, dod=408.075mm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SinoFanArc{Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}, Float32} :
 nb::Int64 888
 d::Unit{Float64} 1.0239 mm
 offset::Float32 1.25
 na::Int64 984
 orbit::Float32 360.0
 orbit_start::Float32 0.0
 source_offset::Unit{Float64} 0.0 mm
 dsd::Unit{Float64} 949.075 mm
 dod::Unit{Float64} 408.075 mm
</code></pre><p>Here is a smaller example for plotting the rays.</p><pre><code class="language-julia hljs">rg = SinoFanArc( ; nb=64, na=30,
    d=20mm, offset=0.25, dsd=900mm, dod=400mm)
sino_plot_rays(rg; ylims=(-50,400), yticks=(0:180:360), widen=true,
    title=&quot;Fan-beam for arc detector&quot;)</code></pre><img src="c99b625e.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()</code></pre><h2 id="Fan-beam-CT-with-a-flat-detector"><a class="docs-heading-anchor" href="#Fan-beam-CT-with-a-flat-detector">Fan-beam CT with a flat detector</a><a id="Fan-beam-CT-with-a-flat-detector-1"></a><a class="docs-heading-anchor-permalink" href="#Fan-beam-CT-with-a-flat-detector" title="Permalink"></a></h2><p>This geometry is the same as the arc detector except that <code>dfs=Inf</code>.</p><pre><code class="language-julia hljs">rg = SinoFanFlat( ; nb=64, na=30,
    d=20mm, offset=0.25, dsd=900mm, dod=400mm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SinoFanFlat{Unitful.Quantity{Float32, 𝐋, Unitful.FreeUnits{(mm,), 𝐋, nothing}}, Float32} :
 nb::Int64 64
 d::Unit{Float32} 20.0f0 mm
 offset::Float32 0.25
 na::Int64 30
 orbit::Float32 360.0
 orbit_start::Float32 0.0
 source_offset::Unit{Float32} 0.0f0 mm
 dsd::Unit{Float32} 900.0f0 mm
 dod::Unit{Float32} 400.0f0 mm
</code></pre><p>Here is its sampling plot</p><pre><code class="language-julia hljs">sino_plot_rays(rg; ylims=(-50,400), yticks=(0:180:360), widen=true,
    title=&quot;Fan-beam for flat detector&quot;)</code></pre><img src="31e68f6d.svg" alt="Example block output"/><pre><code class="language-julia hljs">prompt()</code></pre><h2 id="Mojette-sampling"><a class="docs-heading-anchor" href="#Mojette-sampling">Mojette sampling</a><a id="Mojette-sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Mojette-sampling" title="Permalink"></a></h2><p>This is a specialized sampling geometry that is currently incompletely supported.</p><pre><code class="language-julia hljs">rg = SinoMoj( ; nb=60, na=30)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SinoMoj{Float32, Float32} :
 nb::Int64 60
 d::Float32 1.0
 offset::Float32 0.0
 na::Int64 30
 orbit::Float32 180.0
 orbit_start::Float32 0.0
</code></pre><p>Here is its sampling plot</p><pre><code class="language-julia hljs">sino_plot_rays(rg; ylims=(0,180), yticks=(0:90:180), widen=true,
    title=&quot;Mojette sampling&quot;)</code></pre><img src="19cefacd.svg" alt="Example block output"/><p>Here is a diagram that illustrates how the radial spacing is a function of the projection view angle for the Mojette geometry. The key aspect here is that in each image row the line intersection lengths are identical.</p><pre><code class="language-julia hljs">plot(xlims=(-1,1) .* 3.5, ylims = (-1,1) .* 2.5, xlabel=&quot;x&quot;, ylabel=&quot;x&quot;)
default(label=&quot;&quot;)
for y in -2:2
    plot!([-3, 3], [y, y], color=:black)
end
for x in -3:3
    plot!([x, x], [-2, 2], color=:black)
end
plot_ray!(r, ϕ) = plot!(
    r*cos(ϕ) .+ [-1, 1] * 4 * sin(ϕ),
    r*sin(ϕ) .+ [1, -1] * 4 * cos(ϕ),
    color = :blue,
)
ia = 4 # pick an angle
i = rays(rg) # iterator
rs = [i[1] for i in i] # radial samples
ϕs = [i[2] for i in i] # projection angle
r = rs[:,ia]
r = r[abs.(r) .&lt; 3]
ϕ = ϕs[1,ia]
plot_ray!.(r, ϕ)
plot!(aspect_ratio=1, title = &quot;Mojette line integrals&quot;)</code></pre><img src="005fe2db.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../01-tomography/">« Tomography overview</a><a class="docs-footer-nextpage" href="../03-parallel-beam/">Parallel-beam tomography »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 7 January 2025 04:24">Tuesday 7 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
